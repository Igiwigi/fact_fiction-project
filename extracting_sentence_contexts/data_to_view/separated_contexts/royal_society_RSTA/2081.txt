Note that for better readability we identify
L, = L(t), u, = u(t), and u; = u(t). (Online version in colour.)

One can easily check that

2m M-m
t) = ———_ —— u(t 2. WO = erg pg MO, (23)

where m is the gas particle mass and v, is the gas particle velocity in the z-direction. The
rebounding velocity is given by

, 2M _ M-m
v= u(t) —
M+m M+m

vz. (2.4)

By employing the fact that we control the macroscopic force Finstant =Ma(t) smoothly on
macroscopic time scales, so that for two subsequent collisions it is (on average) true that
a(t + At)A’ ~a(t)At, where At is the time elapsing between first and second collision at time t
and t + At and A’ is a the time elapsing between the second collision and the third one at time
t+ At+ Af# and, further, that L(t) = (L(t + At) — L(f)/At, we obtain

2m
M+m

[vz — Li] = [iw - wo] At, (2.5)

M
M+m
with At being the time span elapsing between collisions (compare electronic supplementary
material (see the electronic supplementary material). Equivalently, we can write 2m[vz — LP =
(M+ m)L(t) — Ma(t)]Az, where Az =[vz — L(D]At represents the inter-particle distance in the
z direction, for particles with the corresponding velocity component vz. The origin of history
dependence in our thermal system can be at this point retraced to the left-hand side of
equation (2.5), which clearly breaks the time-reversal symmetry of the moving piston.