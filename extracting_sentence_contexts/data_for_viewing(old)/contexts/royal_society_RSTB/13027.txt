'=

interval of the fold enrichment. Fold enrichments above 10 are represented at 10. When this happens, the confidence interval is not represented. However, the  S
lowest edge of the confidence intervals not represented are all above 1. Red dots: bootstrap test p < 0.001 (see Methods). Dashed line: fold enrichment of 1, i.e. no

enrichment. Fold enrichment (y-axis) is the number of VIPs in candidate sweeps divided by the average number of control non-VIPs in candidate sweeps. VIPs and =

S
non-VIPs in candidate sweeps are counted if they belong to the top x iHS genes (x-axis), where x is a rank threshold that slides from top 2000 to top 20, takingin =~
total 25 values (2000; 1500; 1000; 900; 800; 700; 600; 500; 450; 400; 350; 300; 250; 200; 150; 100; 90; 80;70; 60; 50; 40;30; 25; 20). A fold enrichment ofy = 3.51 cs

at top x= 100 means that there are 3.51 times more VIPs in the top 100 iHS genes than control non-VIPs on average (over 1000 control sets of non-VIPs). There are =
in fact 80 VIPs in the iHS top 100, versus only 22.7 control non-VIPs. Eighty is high compared to 100 because of the summing over all 26 human populations.  &
Specifically, a VIP or non-VIP counts as one in the top x if it is in the top x of at least one of the 26 populations. Note that counting the number of genes instead of =
counting the number of sweeps ignores the clustering of multiple genes in a single sweep, but that we account for this potential bias when estimating the whole =
rank threshold curve significance (see Methods). (b) Zoom-in on fold enrichment values from zero to two. (Online version in colour.)

stringent threshold for the top 20 genes (figure 1, x-axis). The top (0) RNA viruses drove more recent selective sweeps than
2000 genes include even weak sweep signals, while the top 20 .
genes only correspond to strong sweep candidates. Using a slid- DNA viruses
ing rank threshold thus avoids making assumptions on exactly The strong excess of iHS selective sweeps at VIPs suggests
how strong adaptation to viruses needs to be, and enables the that there may be enough statistical power to cut the set of
detection of enrichments for strong selective sweeps (top 100 VIPs further into smaller categories, and ask which types of
or less) as well as enrichments driven by more incomplete or viruses drove this signal. Specific viruses may have indeed
weaker, polygenic hitchhiking signals spread across more driven more epidemics than others in recent evolution, and